FROM tensorflow/tensorflow:1.8.0-gpu-py3

RUN pip install kaggle pydensecrf
RUN pip install scikit-image
RUN mkdir /root/.kaggle
RUN TXT='{"username":"adamhart","key":"2164e2302b9f4abd328915e808b0ae86"}' && echo $TXT > /root/.kaggle/kaggle.json
RUN pip install neptune-cli

RUN mkdir /root/.neptune_tokens
RUN TXT='{"session_state": "ba0f3545-cd4b-4fbe-ad93-154478544385", "access_token": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFS1dvUkZhUGJVdGlwSHVmVVpmVzZYWm1VT2J1VmR2T28yQXNNTkpacHBzIn0.eyJqdGkiOiI2Y2E4ZTFmNC01MGQyLTQ0NjYtOWI4NC1jOTQ3MmVmY2RlMDAiLCJleHAiOjE1MzMyMTQyNDksIm5iZiI6MCwiaWF0IjoxNTMzMjEyNDQ5LCJpc3MiOiJodHRwczovL2F1dGgubmVwdHVuZS5tbC9hdXRoL3JlYWxtcy9uZXB0dW5lIiwiYXVkIjoibmVwdHVuZS1jbGkiLCJzdWIiOiJmOTEzYmM1MC1lNmFlLTQ3ODgtOWNiMC1lM2U3NjJmNGY0OTgiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJuZXB0dW5lLWNsaSIsImF1dGhfdGltZSI6MTUzMzIwOTA4Niwic2Vzc2lvbl9zdGF0ZSI6ImJhMGYzNTQ1LWNkNGItNGZiZS1hZDkzLTE1NDQ3ODU0NDM4NSIsImFjciI6IjAiLCJjbGllbnRfc2Vzc2lvbiI6IjE0ODM0ZmU0LThlZGEtNDM2YS04MjA0LWFhOTY3OTQyMDIwMyIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vbG9jYWxob3N0KiIsImh0dHBzOi8vYXBwLm5lcHR1bmUubWwiLCJodHRwczovL2F1dGgubmVwdHVuZS5tbCIsImh0dHBzOi8vYXV0aC5uZXB0dW5lLm1sLyoiLCJodHRwOi8vbG9jYWxob3N0OioiLCJodHRwczovL25lcHR1bmUubWwvKiIsImh0dHBzOi8vYXBwLm5lcHR1bmUubWwvKiIsImh0dHBzOi8vbmVwdHVuZS5tbCJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsibmVwdHVuZV93cml0ZSIsIm9mZmxpbmVfYWNjZXNzIiwibmVwdHVuZV9yZWFkIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJicm9rZXIiOnsicm9sZXMiOlsicmVhZC10b2tlbiJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwibG9naW5NZXRob2QiOiJnb29nbGUiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZGFtZmplbGRzdGVkIiwibmVwdHVuZUhvc3QiOiJodHRwczovL2FwcC5uZXB0dW5lLm1sIiwiZW1haWwiOiJhZGFtLmZqZWxkc3RlZEBiZXJnZS5pbyJ9.bhhVGvMSlDc3YdjTPY95O5KthTAzF76U2UrPdz6N7m4aTwj7jnWsI1Qc80MZTrccNQJAPouU7tU1f9dY6fTJM36hfHMLheZlLq5fOePD1lpWwIp4neCy89GXGzgEhb3uoFowl7X9DE43lNOFaJJa0_aYrdK1x43PZwRVMknR0WFMi_vHMYiaD0CGXms3PjkYkwGIunIEHjD7kGC6KRieLt18ufzP_goB1DMggZ7tb6h73Imlr_1oCl3ve-w0xGjyxhpKPJKOenjCvzoBZL7bgAWPS1R4z7KF7wtBQSjld2PUIlpOtAiWz1WrwnrKKcSZYcSjJeRz9bAXcGsZN5KfGA", "id_token": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFS1dvUkZhUGJVdGlwSHVmVVpmVzZYWm1VT2J1VmR2T28yQXNNTkpacHBzIn0.eyJqdGkiOiJhNGJkYjJiZS0wOTJiLTQ0NzgtYTBiMi0zMmJiMjQ2Zjg4MTEiLCJleHAiOjE1MzMyMTQyNDksIm5iZiI6MCwiaWF0IjoxNTMzMjEyNDQ5LCJpc3MiOiJodHRwczovL2F1dGgubmVwdHVuZS5tbC9hdXRoL3JlYWxtcy9uZXB0dW5lIiwiYXVkIjoibmVwdHVuZS1jbGkiLCJzdWIiOiJmOTEzYmM1MC1lNmFlLTQ3ODgtOWNiMC1lM2U3NjJmNGY0OTgiLCJ0eXAiOiJJRCIsImF6cCI6Im5lcHR1bmUtY2xpIiwiYXV0aF90aW1lIjoxNTMzMjA5MDg2LCJzZXNzaW9uX3N0YXRlIjoiYmEwZjM1NDUtY2Q0Yi00ZmJlLWFkOTMtMTU0NDc4NTQ0Mzg1IiwiYWNyIjoiMCIsImxvZ2luTWV0aG9kIjoiZ29vZ2xlIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYWRhbWZqZWxkc3RlZCIsIm5lcHR1bmVIb3N0IjoiaHR0cHM6Ly9hcHAubmVwdHVuZS5tbCIsImVtYWlsIjoiYWRhbS5mamVsZHN0ZWRAYmVyZ2UuaW8ifQ.lHIxhWqye0GHl3Y4CWkYMBbH8gwLhsU8byR4XmvySWOAxnR__046wj1SDOpqYKnLt_MtuW2n-L3RCV0-sfT3xrDDlOETX2fGmG4cIxzPUXDJT7iR6b0vcK4xKj4w_ghKBO9wrUBfv4dxnfI1SdnsQDeMFcO6BXHuXwdz8-zPRsf9f8DnXqBMp7_ehHUPzR-pLjArobMqFD9HuZsxPGkeGyVqXHtjNbnhuRiNV4QdVYBDOoY-tcKZBBlf8B7OJZis2lbCvnLucSKpIssgVcrX9Y13Ijl6Ty7YzeqSJLiS0ONGdv5ymI0cMJocYMfrSor_EgiJzVU9Uyot37fNhXYiHQ", "expires_in": 1800, "token_type": "bearer", "not-before-policy": 1501576317, "refresh_expires_in": 0, "refresh_token": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFS1dvUkZhUGJVdGlwSHVmVVpmVzZYWm1VT2J1VmR2T28yQXNNTkpacHBzIn0.eyJqdGkiOiIzNjBlNzUzMC02YjQ2LTQxNTAtYTNiNy1hYzA3OWMzY2EyN2QiLCJleHAiOjAsIm5iZiI6MCwiaWF0IjoxNTMzMjEyNDQ5LCJpc3MiOiJodHRwczovL2F1dGgubmVwdHVuZS5tbC9hdXRoL3JlYWxtcy9uZXB0dW5lIiwiYXVkIjoibmVwdHVuZS1jbGkiLCJzdWIiOiJmOTEzYmM1MC1lNmFlLTQ3ODgtOWNiMC1lM2U3NjJmNGY0OTgiLCJ0eXAiOiJPZmZsaW5lIiwiYXpwIjoibmVwdHVuZS1jbGkiLCJhdXRoX3RpbWUiOjAsInNlc3Npb25fc3RhdGUiOiJiYTBmMzU0NS1jZDRiLTRmYmUtYWQ5My0xNTQ0Nzg1NDQzODUiLCJjbGllbnRfc2Vzc2lvbiI6IjE0ODM0ZmU0LThlZGEtNDM2YS04MjA0LWFhOTY3OTQyMDIwMyIsInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJuZXB0dW5lX3dyaXRlIiwib2ZmbGluZV9hY2Nlc3MiLCJuZXB0dW5lX3JlYWQiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImJyb2tlciI6eyJyb2xlcyI6WyJyZWFkLXRva2VuIl19LCJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19fQ.iGmxquSLd6T1tzOqbiaO3NUhsPh-nB7guoDTz7_1hwVaejXR7aX3mpHFKZQuqeESJORcBHknbNnlKPn01B9OykQJMKoIWU6nZvrisu5sbrS1T7Qaag6CTVv64YLycm-vaOkavLElavWyx4dmiVXDPxpA3QFQe9sfUNr2BcG5Sk7LzTT7SJe5UAIrVGow3XxJjcOssviWbtz9Zwqw6UuKqVB_12fbh5mqdRvhwZ0iojAxYDjMAv-0lS2uyElTUELWDChuESRZc26mKfcgqIwKM90QXq4mnEdsRzD9vbaqxsLzOKDRqu5uBYktgoXJITEF5qUH-ROGT-QRDXAp-ztW8g"}' && echo $TXT > /root/.neptune_tokens/token

RUN pip install opencv-python==3.3.0.9
RUN pip install imgaug

RUN apt-get update && apt-get install -y git
RUN git clone https://github.com/tensorflow/models
RUN cd models/research/slim && pip install .